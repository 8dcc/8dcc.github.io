<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Understanding Church numerals</title>
<meta property="og:title" content="Understanding Church numerals" />
<meta name="author" content="8dcc" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="icon" type="image/x-icon" href="../img/favicon.png">
<link rel="stylesheet" type="text/css" href="../css/main.css">
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="org-div-home-and-up">
  <a accesskey="u" href="index.html">Up</a> | <a accesskey="h" href="../index.html">Home</a>
</div><div id="content" class="content">
<h1 class="title">Understanding Church numerals</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#church-numerals">2. Church numerals</a></li>
<li><a href="#increasing-a-number">3. Increasing a number</a>
<ul>
<li><a href="#definition-of-add-1">3.1. Definition of <code>add-1</code></a></li>
<li><a href="#beta-reduction">3.2. Beta reduction</a></li>
<li><a href="#calculating-two">3.3. Calculating <code>two</code></a></li>
</ul>
</li>
<li><a href="#arbitrary-addition">4. Arbitrary addition</a>
<ul>
<li><a href="#the-abstract-objective">4.1. The abstract objective</a></li>
<li><a href="#building-the-procedure">4.2. Building the procedure</a></li>
</ul>
</li>
<li><a href="#calling-church-numerals">5. Calling Church numerals</a></li>
</ul>
</div>
</div>

<div id="outline-container-introduction" class="outline-2">
<h2 id="introduction"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-introduction">
<p>
Church numerals are a representation of the natural numbers in the context of
<i>lambda calculus</i>. Church numerals, as well as lambda calculus itself, was
invented by the mathematician and computer scientist <a href="https://en.wikipedia.org/wiki/Alonzo_Church">Alonzo Church</a>.
</p>

<p>
This article was mainly motivated by <a href="https://web.mit.edu/6.001/6.037/sicp.pdf#section*.65">Exercise 2.6</a> of <a href="https://en.wikipedia.org/wiki/Structure_and_Interpretation_of_Computer_Programs">Structure and
Interpretation of Computer Programs</a>.
</p>
</div>
</div>

<div id="outline-container-church-numerals" class="outline-2">
<h2 id="church-numerals"><span class="section-number-2">2.</span> Church numerals</h2>
<div class="outline-text-2" id="text-church-numerals">
<p>
In &lambda;-calculus, numbers are encoded as functions, where the value of the
number depends on the number of function calls that are performed from the
body. The following table shows the first four numbers encoded as church
numerals in lambda notation and conventional function notation (after <i>uncurrying</i>
them into two-argument functions).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Decimal</th>
<th scope="col" class="org-left">&lambda;-notation</th>
<th scope="col" class="org-left">Function notation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0</td>
<td class="org-left">\(\lambda f. \lambda x. x\)</td>
<td class="org-left">\(\text{zero}(f, x) = x\)</td>
</tr>

<tr>
<td class="org-left">1</td>
<td class="org-left">\(\lambda f. \lambda x. f\ x\)</td>
<td class="org-left">\(\text{one}(f, x) = f(x)\)</td>
</tr>

<tr>
<td class="org-left">2</td>
<td class="org-left">\(\lambda f. \lambda x. f\ (f\ x)\)</td>
<td class="org-left">\(\text{two}(f, x) = f(f(x))\)</td>
</tr>

<tr>
<td class="org-left">3</td>
<td class="org-left">\(\lambda f. \lambda x. f\ (f\ (f\ x))\)</td>
<td class="org-left">\(\text{three}(f, x) = f(f(f(x)))\)</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
Note how the decimal value matches the number of recursive applications of \(f\)
inside the body of the innermost lambda. Therefore, a Church numeral with a
value of 3 is simply a function that does something three times.
</p>
</div>
</div>

<div id="outline-container-increasing-a-number" class="outline-2">
<h2 id="increasing-a-number"><span class="section-number-2">3.</span> Increasing a number</h2>
<div class="outline-text-2" id="text-increasing-a-number">
<p>
As mentioned in the introduction, this article was motivated by Exercise 2.6 of
SICP. This exercise provides the reader with the previous definition of <code>zero</code>
along with an <code>add-1</code> procedure, which increases its input; from those
definitions, the reader is expected to calculate <code>one</code>.
</p>

<p>
Although the value of <code>one</code> was shown in the previous section for illustrating
Church numerals, it&rsquo;s worth going over the expansion of <code>add-1</code> in detail.
</p>
</div>

<div id="outline-container-definition-of-add-1" class="outline-3">
<h3 id="definition-of-add-1"><span class="section-number-3">3.1.</span> Definition of <code>add-1</code></h3>
<div class="outline-text-3" id="text-definition-of-add-1">
<p>
This is the definition of <code>add-1</code> in &lambda;-notation<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>.
</p>

<p>
\[
\lambda n. \lambda f. \lambda x. f (n\ f\ x)
\]
</p>

<p>
This is the equivalent definition of <code>add-1</code> in Lisp.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #a60000;">(</span><span style="color: #972500;">define</span> <span style="color: #3f578f;">add-1</span>
  <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>n<span style="color: #006800;">)</span>
    <span style="color: #006800;">(</span><span style="color: #972500;">lambda</span> <span style="color: #008899;">(</span>f<span style="color: #008899;">)</span>
      <span style="color: #008899;">(</span><span style="color: #972500;">lambda</span> <span style="color: #0000ff;">(</span>x<span style="color: #0000ff;">)</span>
        <span style="color: #0000ff;">(</span>f <span style="color: #dd22dd;">(</span><span style="color: #a60000;">(</span>n f<span style="color: #a60000;">)</span> x<span style="color: #dd22dd;">)</span><span style="color: #0000ff;">)</span><span style="color: #008899;">)</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-beta-reduction" class="outline-3">
<h3 id="beta-reduction"><span class="section-number-3">3.2.</span> Beta reduction</h3>
<div class="outline-text-3" id="text-beta-reduction">
<p>
Through &beta;-reduction, a call to <code>add-1</code> with an argument of <code>zero</code> can be
examined, understanding why the Church numeral for <code>one</code> is returned. Each step
of the reduction will be explained and highlighted using Lisp syntax.
</p>

<p>
First, the call to <code>add-1</code> is expanded, replacing each symbol with its bound
expression.
</p>


<div id="fig1" class="figure">
<p><img src="../img/understanding-church-numerals1.svg" alt="understanding-church-numerals1.svg" class="org-svg" />
</p>
</div>

<p>
Then, the outermost call is evaluated, replacing the <code>n</code> parameter in the body of
<code>add-1</code> with the value of <code>zero</code>. Specifically, to avoid naming collisions, <code>n</code> is
replaced with the &alpha;-conversion of <code>zero</code>, where the symbols <code>f</code> and <code>x</code> are
substituted with <code>g</code> and <code>y</code>, respectively.
</p>


<div id="fig2" class="figure">
<p><img src="../img/understanding-church-numerals2.svg" alt="understanding-church-numerals2.svg" class="org-svg" />
</p>
</div>

<p>
Once the outer call has been evaluated, the expression can be simplified by
evaluating the call to <code>zero</code>, that is, the call to the lambda whose parameter is
<code>y</code>, and whose argument is <code>f</code>. Since the parameter <code>g</code> does not appear in the body,
is is essentially discarded, resulting in <code>(lambda (y) y)</code>, the <i>identity</i> function.
</p>


<div id="fig3" class="figure">
<p><img src="../img/understanding-church-numerals3.svg" alt="understanding-church-numerals3.svg" class="org-svg" />
</p>
</div>

<p>
Finally, the call to the identity lambda can be evaluated, that is, the call to
the lambda whose parameter is <code>z</code> and whose argument is <code>x</code>. This call simply
evaluates to the argument, <code>x</code>. The final expression matches the definition of <code>one</code>
from the previous section.
</p>


<div id="fig4" class="figure">
<p><img src="../img/understanding-church-numerals4.svg" alt="understanding-church-numerals4.svg" class="org-svg" />
</p>
</div>

<p>
Naturally, the same &beta;-reduction process can be expressed in
&lambda;-notation.
</p>

\begin{align*}
\text{one} &= (\lambda n. \lambda f. \lambda x. f\ (n\ f\ x))
              (\lambda f. \lambda x. x) \\
           &= \lambda f. \lambda x. f\ ((\lambda g. \lambda y. y)\ f\ x) \\
           &= \lambda f. \lambda x. f\ ((\lambda y. y)\ x) \\
           &= \lambda f. \lambda x. f\ x
\end{align*}
</div>
</div>

<div id="outline-container-calculating-two" class="outline-3">
<h3 id="calculating-two"><span class="section-number-3">3.3.</span> Calculating <code>two</code></h3>
<div class="outline-text-3" id="text-calculating-two">
<p>
The same process can be done to &beta;-reduce a call to <code>add-1</code> with an argument of
<code>one</code>. From the previous definitions:
</p>

\begin{align*}
\text{add-1} &= \lambda n. \lambda f. \lambda x. f\ (n\ f\ x) \\
\text{one} &= \lambda f. \lambda x. f\ x \\
\end{align*}

<p>
The following &beta;-reduction process can be performed:
</p>

\begin{align}
\text{two} &= (\lambda n. \lambda f. \lambda x. f\ (n\ f\ x))
              (\lambda f. \lambda x. f\ x) \label{eq:definition} \\
           &= \lambda f. \lambda x. f\ ((\lambda g. \lambda y. g\ y)\ f\ x) \label{eq:reduction} \\
           &= \lambda f. \lambda x. f\ ((\lambda y. f\ y)\ x) \label{eq:reduction2} \\
           &= \lambda f. \lambda x. f\ (f\ x) \label{eq:solution}
\end{align}

<p>
The initial expression \(\eqref{eq:definition}\) is simply the call to <code>add-1</code>,
replacing the symbols with the values defined above. Then, the call is
&beta;-reduced in \(\eqref{eq:reduction}\) by replacing the parameter \(n\) with the
argument <code>one</code>, which was &alpha;-converted to avoid parameter collisions, just
like when examining the example from the previous section. The call to the
innermost lambda is &beta;-reduced in \(\eqref{eq:reduction2}\) produce
\((\lambda y. f\ y)\), that is, a function that applies \(f\) to its
argument. Finally, the call to that lambda, whose argument is \(x\), is also
reduced into \((f\ x)\); this result \(\eqref{eq:solution}\) matches the definition
of <code>two</code> from the <a href="#church-numerals">previous section</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-arbitrary-addition" class="outline-2">
<h2 id="arbitrary-addition"><span class="section-number-2">4.</span> Arbitrary addition</h2>
<div class="outline-text-2" id="text-arbitrary-addition">
<p>
Although the previous section explained how to increase a Church numeral, the
<code>add-1</code> function was already provided. The second part of the exercise asks for a
definition of the addition procedure, avoiding repeated calls to <code>add-1</code>.
</p>

<p>
It is helpful to analyze the inputs of this new addition function, along with
the expected output. In Lisp, these would be defined as the following three
expressions.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #a60000;">(</span><span style="color: #972500;">lambda</span> <span style="color: #695500;">(</span>f<span style="color: #695500;">)</span> <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>x<span style="color: #006800;">)</span> <span style="color: #006800;">(</span>f <span style="color: #008899;">(</span>f x<span style="color: #008899;">)</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>              <span style="color: #595959;">; </span><span style="color: #595959;">Input `a': Two</span>
<span style="color: #a60000;">(</span><span style="color: #972500;">lambda</span> <span style="color: #695500;">(</span>f<span style="color: #695500;">)</span> <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>x<span style="color: #006800;">)</span> <span style="color: #006800;">(</span>f <span style="color: #008899;">(</span>f <span style="color: #0000ff;">(</span>f x<span style="color: #0000ff;">)</span><span style="color: #008899;">)</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>          <span style="color: #595959;">; </span><span style="color: #595959;">Input `b': Three</span>
<span style="color: #a60000;">(</span><span style="color: #972500;">lambda</span> <span style="color: #695500;">(</span>f<span style="color: #695500;">)</span> <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>x<span style="color: #006800;">)</span> <span style="color: #006800;">(</span>f <span style="color: #008899;">(</span>f <span style="color: #0000ff;">(</span>f <span style="color: #dd22dd;">(</span>f <span style="color: #a60000;">(</span>f x<span style="color: #a60000;">)</span><span style="color: #dd22dd;">)</span><span style="color: #0000ff;">)</span><span style="color: #008899;">)</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>  <span style="color: #595959;">; </span><span style="color: #595959;">Result: Five</span>
</pre>
</div>
</div>

<div id="outline-container-the-abstract-objective" class="outline-3">
<h3 id="the-abstract-objective"><span class="section-number-3">4.1.</span> The abstract objective</h3>
<div class="outline-text-3" id="text-the-abstract-objective">
<p>
From the previous expressions, it can be concluded that the new addition
function should essentially replace <code>x</code> (in either expression, because addition is
<a href="https://en.wikipedia.org/wiki/Commutative_property">commutative</a>) with the entire body of the other expression&rsquo;s innermost lambda.
</p>

<p>
This abstract process is represented in the following figure, which shows the
expected behavior when adding the Church numeral representation of 2 and 3.
</p>


<div id="fig5" class="figure">
<p><img src="../img/understanding-church-numerals5.svg" alt="understanding-church-numerals5.svg" class="org-svg" />
</p>
</div>

<p>
For simplicity, this approach will be used for the rest of the section, where
the body of the first argument <code>a</code> is &ldquo;placed&rdquo; in the second argument <code>b</code>.
</p>
</div>
</div>

<div id="outline-container-building-the-procedure" class="outline-3">
<h3 id="building-the-procedure"><span class="section-number-3">4.2.</span> Building the procedure</h3>
<div class="outline-text-3" id="text-building-the-procedure">
<p>
Since the parameters of <code>add</code> are known, its initial structure can be defined. The
following figure shows the initial definition, which will evolve trough this
section.
</p>


<div id="fig6" class="figure">
<p><img src="../img/understanding-church-numerals6.svg" alt="understanding-church-numerals6.svg" class="org-svg" />
</p>
</div>

<p>
Since the function will manipulate the bodies of the innermost lambdas, it must
be able to access them. Specifically, it needs to:
</p>

<ol class="org-ol">
<li>Extract the innermost body from <code>a</code>, that is, <code>(f (f x))</code>.</li>
<li>Replace <code>x</code> in the innermost body of <code>b</code>.</li>
</ol>

<p>
Since the numbers themselves are functions, replacing <code>x</code> in the inner body of <code>b</code>
should be as simple as calling its inner lambda with the desired value as an
argument. To access and call the inner lambda, the outer lambda, whose parameter
is <code>f</code>, needs to be called first, but it obviously needs some value as its
argument.
</p>

<p>
As noted above, Church numerals express &ldquo;repeated operations&rdquo;, and their <code>f</code>
argument represents the function that performs the operation itself. Since the
result of adding two Church numerals must be another Church numeral, which will
also express some &ldquo;repeated operation&rdquo;, there is no way for <code>add</code> to know the
operation that the result is expected to repeat; therefore, the result must also
be a function with an <code>f</code> parameter, which lets the caller specify a function to
be repeated.
</p>

<p>
Since the result of <code>add</code> now contains a lambda with an <code>f</code> parameter, that unknown
value of <code>f</code> can be used to call <code>b</code>, accessing the inner lambda. Although there is
now a way of calling the inner lambda of <code>b</code> for altering <code>x</code>, it&rsquo;s still
not clear how to obtain the argument: the body of <code>a</code>. Either way, the definition
of <code>add</code> can be expanded to reflect this new knowledge.
</p>


<div id="fig7" class="figure">
<p><img src="../img/understanding-church-numerals7.svg" alt="understanding-church-numerals7.svg" class="org-svg" />
</p>
</div>

<p>
The inner body of <code>a</code> can be obtained through a similar process. Just like when
calling <code>b</code>, the value of <code>f</code> can be used for calling the outer lambda; however,
in this case the inner lambda needs to be called for retrieving the body.
</p>

<p>
A similar problem emerges: what value should be used as the <code>x</code> argument of the
inner lambda of <code>a</code>? Going back to the &ldquo;repeated operations&rdquo;, <code>x</code> represents the
input of the operation, in other words, the value to which the operation should
be applied. Just like with the function itself, <code>add</code> cannot know this value when
computing its result, so it must use another generic lambda that receives <code>x</code>.
</p>

<p>
With this, the previous two steps of <i>extraction</i> and <i>replacement</i> can be
performed. The following figure shows the final definition of <code>add</code> in Lisp.
</p>


<div id="fig8" class="figure">
<p><img src="../img/understanding-church-numerals8.svg" alt="understanding-church-numerals8.svg" class="org-svg" />
</p>
</div>

<p>
Note that the previous Lisp definition &ldquo;replaces&rdquo; the body of <code>a</code> into <code>b</code>, but the
conventional definition in &lambda;-notation is:
</p>

<p>
\[
\text{add} = \lambda ab. \lambda f. \lambda x. a\ f\ (b\ f\ x)
\]
</p>

<p>
Which would move the body of <code>b</code> into <code>a</code>. Again, this is not an issue because
addition is commutative.
</p>
</div>
</div>
</div>

<div id="outline-container-calling-church-numerals" class="outline-2">
<h2 id="calling-church-numerals"><span class="section-number-2">5.</span> Calling Church numerals</h2>
<div class="outline-text-2" id="text-calling-church-numerals">
<p>
To further illustrate why Church numerals are functions that represent repeated
operations, a call to one of them will be made below. First, a simple definition
of <code>increase</code>:
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #a60000;">(</span><span style="color: #972500;">define</span> <span style="color: #3f578f;">increase</span>
  <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>val<span style="color: #006800;">)</span>
    <span style="color: #006800;">(</span>+ val <span style="color: #2a5045;">1</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>

<span style="color: #a60000;">(</span>increase <span style="color: #2a5045;">5</span><span style="color: #a60000;">)</span>  <span style="color: #595959;">; </span><span style="color: #595959;">Returns 6</span>
</pre>
</div>

<p>
This <code>increase</code> function can be used as the <code>f</code> argument when calling a Church numeral,
and the result will be another function which applies the operation <i>N</i> times.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #a60000;">(</span><span style="color: #972500;">define</span> <span style="color: #3f578f;">church-three</span>
  <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>f<span style="color: #006800;">)</span>
    <span style="color: #006800;">(</span><span style="color: #972500;">lambda</span> <span style="color: #008899;">(</span>x<span style="color: #008899;">)</span>
      <span style="color: #008899;">(</span>f <span style="color: #0000ff;">(</span>f <span style="color: #dd22dd;">(</span>f x<span style="color: #dd22dd;">)</span><span style="color: #0000ff;">)</span><span style="color: #008899;">)</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>

<span style="color: #a60000;">(</span><span style="color: #972500;">define</span> <span style="color: #3f578f;">increase-by-three</span> <span style="color: #695500;">(</span>church-three increase<span style="color: #695500;">)</span><span style="color: #a60000;">)</span>
</pre>
</div>

<p>
In the previous example, <code>increase-by-three</code> is a function which receives an
argument <code>x</code> and applies <code>increase</code> to it 3 times. Therefore, the two expressions
are equivalent:
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #a60000;">(</span>increase-by-three <span style="color: #2a5045;">10</span><span style="color: #a60000;">)</span>               <span style="color: #595959;">; </span><span style="color: #595959;">Returns 13</span>
<span style="color: #a60000;">(</span>increase <span style="color: #695500;">(</span>increase <span style="color: #006800;">(</span>increase <span style="color: #2a5045;">10</span><span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>  <span style="color: #595959;">; </span><span style="color: #595959;">Returns 13</span>
</pre>
</div>

<p>
Naturally, this is infinitely versatile, as it can be done with any function an
argument:
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #a60000;">(</span><span style="color: #972500;">define</span> <span style="color: #3f578f;">square</span>
  <span style="color: #695500;">(</span><span style="color: #972500;">lambda</span> <span style="color: #006800;">(</span>val<span style="color: #006800;">)</span>
    <span style="color: #006800;">(</span>* val val<span style="color: #006800;">)</span><span style="color: #695500;">)</span><span style="color: #a60000;">)</span>

<span style="color: #595959;">;; </span><span style="color: #595959;">The following expression is equivalent to:</span>
<span style="color: #595959;">;;</span>
<span style="color: #595959;">;;   </span><span style="color: #595959;">(square (square (square 3)))</span>
<span style="color: #595959;">;;</span>
<span style="color: #595959;">;; </span><span style="color: #595959;">Which returns:</span>
<span style="color: #595959;">;;</span>
<span style="color: #595959;">;;   </span><span style="color: #595959;">((3^2)^2)^2 = 3^(2*2*2) = 3^8 = 6561</span>
<span style="color: #595959;">;;</span>
<span style="color: #a60000;">(</span><span style="color: #695500;">(</span>church-three square<span style="color: #695500;">)</span> <span style="color: #2a5045;">3</span><span style="color: #a60000;">)</span>
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">The expression can be
simplified through <a href="https://en.wikipedia.org/wiki/Currying">currying</a>, that is, by transforming multiple lambdas that
receive one argument into a single lambda that receives multiple arguments (in
this case, both \(f\) and \(x\)). The simplified definition would be
\(\lambda n. \lambda f\ x. f (n f x)\).</p></div></div>


</div>
</div></div>
</body>
</html>
